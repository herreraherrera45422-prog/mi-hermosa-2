<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#ff6b8a" />
  <title>Cartita para Ti ðŸ’Œ</title>
  <meta name="description" content="Carta virtual de amor con animaciones romÃ¡nticas. Toca para abrir la carta y leer el mensaje." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --pink:#ff6b8a;       /* principal */
      --soft-pink:#ff9bb0;  /* acento */
      --rose:#ff3d68;       /* fuerte */
      --light:#fff;
      --bg1:#ffe5ec;        /* degradado romÃ¡ntico */
      --bg2:#ffd1dc;
      --bg3:#fff1f4;
      --ink:#753a47;        /* texto */
      --shadow:0 14px 36px rgba(255, 59, 95, .22);
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; color:var(--ink);
      background: radial-gradient(120% 120% at 50% 20%, var(--bg3) 0%, var(--bg1) 50%, var(--bg2) 100%);
      font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, 'Helvetica Neue', Arial;
      overflow:hidden; /* mantÃ©n el foco en la carta */
    }

    /* Corazones/partÃ­culas del fondo */
    .bg{
      position:fixed; inset:0; overflow:hidden; pointer-events:none; z-index:1;
    }
    .bg .heart{
      position:absolute; width:14px; height:14px; background:var(--rose); transform: rotate(45deg);
      opacity:.12; animation: floatUp linear forwards; filter: blur(.4px);
    }
    .bg .heart::before,.bg .heart::after{ content:""; position:absolute; width:100%; height:100%; background:inherit; border-radius:50% }
    .bg .heart::before{ top:-50% }
    .bg .heart::after{ left:-50% }
    @keyframes floatUp{
      0%{ transform: translateY(100vh) rotate(45deg) scale(.7); opacity:0 }
      10%{ opacity:.12 }
      100%{ transform: translateY(-20vh) rotate(45deg) scale(1); opacity:0 }
    }

    /* Luces suaves "bokeh" */
    .bokeh{ position:fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden }
    .bokeh span{ position:absolute; width:120px; height:120px; background: radial-gradient(circle, rgba(255,255,255,.6), rgba(255,255,255,0)); filter: blur(6px); border-radius:50%; animation: drift 18s ease-in-out infinite }
    .bokeh span:nth-child(2){ width:160px; height:160px; left:10%; top:20%; animation-duration:22s }
    .bokeh span:nth-child(3){ width:100px; height:100px; right:15%; top:30%; animation-duration:20s }
    .bokeh span:nth-child(4){ width:180px; height:180px; left:20%; bottom:10%; animation-duration:26s }
    .bokeh span:nth-child(5){ width:140px; height:140px; right:12%; bottom:16%; animation-duration:24s }
    @keyframes drift{
      0%,100%{ transform: translate(0,0) }
      50%{ transform: translate(20px, -26px) }
    }

    /* Contenedor principal centrado */
    .wrap{ position:relative; z-index:2; min-height:100dvh; display:grid; place-items:center; padding:20px }

    .header{ text-align:center; margin-bottom:14px }
    .title{
      font-family:'Great Vibes', cursive; font-size: clamp(40px, 7vw, 80px); margin:0; color:#c2185b;
      text-shadow: 0 2px 0 rgba(255,255,255,.7), 0 6px 24px rgba(194,24,91,.18);
    }
    .subtitle{ margin:6px 0 0; color:#8a4b5a; font-size: clamp(13px, 2.7vw, 16px) }

    /* Carta (sobre) */
    .scene{ position:relative; display:grid; place-items:center; width:min(92vw, 680px) }
    .envelope{
      width:min(86vw, 560px); height:min(56vw, 360px); max-height:380px; position:relative;
      perspective:1000px; filter: drop-shadow(0 16px 24px rgba(255, 59, 95, .18));
    }
    .envelope .base{
      position:absolute; inset:0; background: linear-gradient(180deg, #fff, #ffe6ec);
      border-radius:18px; border:1px solid rgba(255,105,130,.35);
    }
    .envelope .flap{
      position:absolute; left:0; right:0; top:0; height:52%; transform-origin:top; border-top-left-radius:18px; border-top-right-radius:18px;
      background: linear-gradient(180deg, #ffe1ea, #ffc4d2);
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      box-shadow: inset 0 -1px 0 rgba(255,105,130,.35);
      transition: transform .9s cubic-bezier(.22, .61, .36, 1), box-shadow .6s ease;
    }
    .seal{
      position:absolute; top:44%; left:50%; transform:translate(-50%, -50%); width:64px; height:64px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #ff9bb0, #ff6b8a 60%); box-shadow: 0 8px 18px rgba(255, 59, 95, .25);
      display:grid; place-items:center; color:white; font-size:28px; user-select:none;
      transition: transform .45s ease, opacity .45s ease; z-index:2;
    }
    .envelope .pocket{
      position:absolute; left:0; right:0; bottom:0; height:60%; border-bottom-left-radius:18px; border-bottom-right-radius:18px;
      background: linear-gradient(180deg, #ffe6ec, #ffd3de);
      clip-path: polygon(0 0, 50% 38%, 100% 0, 100% 100%, 0 100%);
      box-shadow: inset 0 2px 0 rgba(255,105,130,.25);
    }

    /* Papel que sale de la carta */
    .letter{
      position:absolute; left:50%; top:56%; transform:translate(-50%, -50%) rotateX(0deg); width:86%; max-width:520px; height:68%;
      background: linear-gradient(180deg, #fff, #fff7fa); border:1px solid rgba(255,105,130,.3); border-radius:14px;
      box-shadow: 0 10px 28px rgba(255,59,95,.18), inset 0 1px 0 rgba(255,255,255,.9);
      padding: clamp(16px, 3.2vw, 26px); text-align:center; display:grid; place-items:center; opacity:0;
      transition: transform 1s cubic-bezier(.2, .7, .2, 1), top 1s cubic-bezier(.2,.7,.2,1), opacity .8s ease;
      z-index:3;
    }
    .letter .msg{
      font-family:'Great Vibes', cursive; font-size: clamp(26px, 5.2vw, 42px); color:#b21853; line-height:1.25;
      text-shadow: 0 1px 0 rgba(255,255,255,.7);
    }

    /* Indicador para abrir */
    .tap{ margin-top:14px; text-align:center; color:#9a5f6c; font-size: clamp(14px, 3.5vw, 16px); display:flex; gap:8px; align-items:center; justify-content:center }
    .tap .pulse{ width:10px; height:10px; border-radius:50%; background:var(--pink); box-shadow: 0 0 0 0 rgba(255,107,138,.6); animation: pulse 1.6s ease-out infinite }
    @keyframes pulse{ 0%{ box-shadow: 0 0 0 0 rgba(255,107,138,.6) } 100%{ box-shadow: 0 0 0 18px rgba(255,107,138,0) } }

    /* Estados al abrir */
    .envelope.open .flap{ transform: rotateX(180deg); box-shadow: inset 0 -1px 0 rgba(255,105,130,.2), 0 12px 24px rgba(0,0,0,.08) }
    .envelope.open .seal{ transform: translate(-50%, -50%) scale(.7); opacity:0 }
    .envelope.open + .letter{ top:10%; transform: translate(-50%, 0) rotateX(0deg); opacity:1 }

    /* Botones */
    .actions{ margin-top:14px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap }
    .btn{
      border:0; padding:10px 16px; border-radius:999px; cursor:pointer; font-weight:600; letter-spacing:.3px;
      background: linear-gradient(90deg, var(--pink), var(--soft-pink)); color:white; box-shadow: var(--shadow);
      display:inline-flex; gap:8px; align-items:center; transition: transform .15s ease, box-shadow .3s ease;
    }
    .btn:hover{ transform: translateY(-2px) }
    .btn.secondary{ background: linear-gradient(90deg, #fff, #ffe9ef); color:#c2185b; border:1px solid rgba(255,105,130,.35) }

    .footer{ margin-top:16px; font-size:12px; color:#a16472; text-align:center }

    /* Responsivo */
    @media (max-width:520px){ .subtitle{ display:none } }
  </style>
</head>
<body>
  <!-- Fondo decorativo: bokeh + corazones -->
  <div class="bokeh" aria-hidden="true">
    <span style="left:8%; top:12%"></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
  </div>
  <div class="bg" id="bg" aria-hidden="true"></div>

  <div class="wrap">
    <header class="header">
      <h1 class="title">Para ti, con todo mi amor</h1>
      <p class="subtitle">Haz clic para abrir la carta y descubrir un pedacito de mi corazÃ³n</p>
    </header>

    <section class="scene" aria-label="Carta de amor animada">
      <div class="envelope" id="envelope" role="button" tabindex="0" aria-label="Haz clic para abrir la carta">
        <div class="base"></div>
        <div class="flap"></div>
        <div class="pocket"></div>
        <div class="seal">ðŸ’—</div>
      </div>
      <div class="letter" id="letter" aria-live="polite">
        <div class="msg">Amor, te amo. Muchas gracias por estar todo este tiempo conmigo. Eres lo mejor que me ha pasado.</div>
      </div>
      <div class="tap" id="tapHint"><span class="pulse"></span> Haz clic para abrir la carta</div>

      <div class="actions">
        <button class="btn" id="btnMusic" aria-label="Reproducir mÃºsica romÃ¡ntica">ðŸŽµ Reproducir mÃºsica</button>
        <button class="btn secondary" id="btnHearts" aria-label="Alternar corazones de fondo">ðŸ’– Corazones</button>
      </div>
      <p class="footer">Hecho con amor ðŸ’˜</p>
    </section>
  </div>

  <!-- MÃºsica romÃ¡ntica libre -->
  <audio id="audio" preload="auto" crossorigin="anonymous">
    <source src="https://cdn.pixabay.com/download/audio/2022/02/24/audio_9a3f5bc1b3.mp3?filename=beautiful-piano-ambient-110855.mp3" type="audio/mpeg" />
  </audio>

  <script>
    // Corazones flotantes de fondo
    function setupBackgroundHearts(container){
      let enabled = true; const max = 36; const nodes = [];
      function spawn(){
        if(!enabled) return;
        if(nodes.length < max){
          const h = document.createElement('span'); h.className = 'heart';
          const size = 10 + Math.random()*18; h.style.width=size+'px'; h.style.height=size+'px';
          h.style.left = Math.random()*100 + 'vw';
          h.style.animationDuration = (18 + Math.random()*16) + 's';
          h.style.animationDelay = (-Math.random()*18) + 's';
          h.style.opacity = (0.06 + Math.random()*0.08).toFixed(2);
          container.appendChild(h); nodes.push(h);
        }
        requestAnimationFrame(spawn);
      }
      function toggle(){ enabled = !enabled; container.style.opacity = enabled ? '1' : '0' }
      spawn();
      return { toggle };
    }

    // Control de mÃºsica
    function setupMusic(){
      const btn = document.getElementById('btnMusic'); const audio = document.getElementById('audio');
      let playing = false;
      function label(){ btn.textContent = playing ? 'â¸ï¸ Pausar mÃºsica' : 'ðŸŽµ Reproducir mÃºsica' }
      btn.addEventListener('click', async ()=>{
        try{
          if(!playing){ await audio.play(); playing = true } else { audio.pause(); playing = false }
          label();
        }catch(e){ alert('Para reproducir mÃºsica, toca el botÃ³n tras interactuar con la pÃ¡gina.'); }
      });
      audio.addEventListener('ended', ()=>{ playing=false; label() });
      audio.volume = 0.6; label();
    }

    // Carta: abrir con animaciÃ³n
    function setupEnvelope(){
      const env = document.getElementById('envelope');
      const letter = document.getElementById('letter');
      const hint = document.getElementById('tapHint');
      let opened = false;
      function open(){
        if(opened) return; opened = true;
        env.classList.add('open');
        // sutil destello al aparecer el papel
        letter.animate([
          { boxShadow:'0 10px 28px rgba(255,59,95,.18), inset 0 1px 0 rgba(255,255,255,.9)' },
          { boxShadow:'0 20px 48px rgba(255,59,95,.28), inset 0 1px 0 rgba(255,255,255,.9)' },
          { boxShadow:'0 10px 28px rgba(255,59,95,.18), inset 0 1px 0 rgba(255,255,255,.9)' }
        ], { duration:900, easing:'ease-out' });
        hint.style.opacity = '.0'; hint.style.transform='translateY(6px)';
        // lanzar pequeÃ±as partÃ­culas al abrir
        burstParticles(env.getBoundingClientRect());
      }
      env.addEventListener('click', open);
      env.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); open(); }});
    }

    function burstParticles(rect){
      const container = document.getElementById('bg');
      for(let i=0;i<16;i++){
        const p = document.createElement('span'); p.className='heart';
        const size = 10 + Math.random()*12; p.style.width=size+'px'; p.style.height=size+'px';
        const x = rect.left + rect.width/2; const y = rect.top + rect.height/2;
        const angle = Math.random()*Math.PI*2; const dist = 40 + Math.random()*80;
        const tx = x + Math.cos(angle)*dist; const ty = y + Math.sin(angle)*dist;
        p.style.left = x+'px'; p.style.top = y+'px'; p.style.position='fixed'; p.style.opacity='0.22';
        container.appendChild(p);
        p.animate([
          { transform:'translate(-50%, -50%) rotate(45deg) scale(.7)', opacity: .22 },
          { transform:`translate(${tx-x}px, ${ty-y}px) rotate(45deg) scale(1)`, opacity: 0 }
        ], { duration: 1200 + Math.random()*600, easing:'cubic-bezier(.22,.61,.36,1)', fill:'forwards' });
        setTimeout(()=> p.remove(), 1900);
      }
    }

    // Toggle corazones
    function setupToggle(bg){
      const btn = document.getElementById('btnHearts');
      btn.addEventListener('click', ()=> btn.classList.toggle('secondary'));
      btn.addEventListener('click', ()=> bg.toggle());
    }

    // Init
    window.addEventListener('DOMContentLoaded', ()=>{
      const bg = setupBackgroundHearts(document.getElementById('bg'));
      setupToggle(bg);
      setupMusic();
      setupEnvelope();
    });
  </script>
</body>
</html>